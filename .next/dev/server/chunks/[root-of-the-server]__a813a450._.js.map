{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///D:/Akshat%20Singh/SideProjIdeas/Desi-Ngl/pages/api/subscribe.js"],"sourcesContent":["import { subscriptionModal } from \"../../../db\";\r\nimport mongoose from \"mongoose\";\r\n\r\nexport default async function handler(req, res) {\r\n    if (req.method !== 'POST') {\r\n        return res.status(405).json({ error: 'Method not allowed' });\r\n    }\r\n\r\n    const { subscription, username } = req.body;\r\n\r\n    if (!subscription || !username) {\r\n        return res.status(400).json({ error: 'Missing subscription or username' });\r\n    }\r\n\r\n    try {\r\n        await subscriptionModal.findOneAndUpdate(\r\n            { username, endpoint: subscription.endpoint }, // Prevent duplicates for same device\r\n            {\r\n                username,\r\n                endpoint: subscription.endpoint,\r\n                keys: subscription.keys\r\n            },\r\n            { upsert: true, new: true }\r\n        );\r\n        res.status(200).json({ message: 'Subscribed successfully' });\r\n    } catch (error) {\r\n        console.error('Subscription error:', error);\r\n        res.status(500).json({ error: 'Failed to subscribe' });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AACA;;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC1C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC9D;IAEA,MAAM,EAAE,YAAY,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;IAE3C,IAAI,CAAC,gBAAgB,CAAC,UAAU;QAC5B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAmC;IAC5E;IAEA,IAAI;QACA,MAAM,kBAAkB,gBAAgB,CACpC;YAAE;YAAU,UAAU,aAAa,QAAQ;QAAC,GAC5C;YACI;YACA,UAAU,aAAa,QAAQ;YAC/B,MAAM,aAAa,IAAI;QAC3B,GACA;YAAE,QAAQ;YAAM,KAAK;QAAK;QAE9B,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAA0B;IAC9D,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAsB;IACxD;AACJ"}}]
}